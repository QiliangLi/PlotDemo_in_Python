from scipy.stats import norm
import matplotlib.pyplot as plt
import numpy as np
import csv
from scipy import stats


def getCDFPlotValue(ratio):
    fs_xk = np.sort(ratio)
    val, cnt = np.unique(ratio, return_counts=True)
    pmf = cnt / len(ratio)
    fs_rv_dist = stats.rv_discrete(name='fs_rv_dist', values=(val, pmf))

    return val, fs_rv_dist


if __name__=="__main__":
    randReadRatio=[1.9333333333333333, 2.2555555555555555, 2.577777777777778, 2.2555555555555555, 2.2555555555555555, 2.2555555555555555, 3.2222222222222223, 2.2555555555555555, 2.2555555555555555, 2.577777777777778, 2.577777777777778, 2.577777777777778, 2.577777777777778, 2.2555555555555555, 2.577777777777778, 2.577777777777778, 2.577777777777778, 2.2555555555555555, 2.9, 2.2555555555555555, 2.577777777777778, 2.577777777777778, 2.2555555555555555, 2.577777777777778, 2.2555555555555555, 1.9333333333333333, 2.2555555555555555, 2.2555555555555555, 2.577777777777778, 2.2555555555555555, 2.577777777777778, 2.577777777777778, 2.9, 3.2222222222222223, 2.577777777777778, 1.9333333333333333, 2.577777777777778, 2.2555555555555555, 2.2555555555555555, 2.577777777777778, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 2.2555555555555555, 2.577777777777778, 2.577777777777778, 1.9333333333333333, 2.2555555555555555, 2.2555555555555555, 2.9, 2.2555555555555555, 1.9333333333333333, 2.577777777777778, 2.577777777777778, 2.9, 2.2555555555555555, 2.9, 2.2555555555555555, 2.2555555555555555, 2.9, 2.2555555555555555, 2.577777777777778, 2.577777777777778, 2.577777777777778, 2.2555555555555555, 2.2555555555555555, 2.2555555555555555, 2.2555555555555555, 2.2555555555555555, 2.2555555555555555, 2.577777777777778, 2.9, 2.9, 2.9, 2.2555555555555555, 2.577777777777778, 2.2555555555555555, 2.2555555555555555, 2.577777777777778, 2.2555555555555555, 1.9333333333333333, 2.577777777777778, 2.577777777777778, 2.2555555555555555, 2.9, 2.577777777777778, 2.2555555555555555, 2.577777777777778, 2.2555555555555555, 2.2555555555555555, 2.577777777777778, 2.577777777777778, 2.577777777777778, 1.9333333333333333, 2.577777777777778, 2.2555555555555555, 1.9333333333333333, 2.577777777777778, 2.577777777777778]
    randWriteRatio=[3.8666666666666667, 5.8, 5.8, 3.8666666666666667, 3.8666666666666667, 5.8, 5.8, 5.8, 3.8666666666666667, 5.8, 3.8666666666666667, 5.8, 5.8, 5.8, 3.8666666666666667, 5.8, 5.8, 3.8666666666666667, 5.8, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 5.8, 3.8666666666666667, 5.8, 3.8666666666666667, 5.8, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 5.8, 5.8, 7.733333333333333, 5.8, 5.8, 3.8666666666666667, 5.8, 3.8666666666666667, 3.8666666666666667, 5.8, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 5.8, 5.8, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 5.8, 5.8, 5.8, 5.8, 3.8666666666666667, 5.8, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 3.8666666666666667, 5.8, 3.8666666666666667, 5.8, 3.8666666666666667, 3.8666666666666667, 5.8, 3.8666666666666667, 3.8666666666666667, 5.8, 5.8, 3.8666666666666667, 5.8, 5.8, 5.8, 7.733333333333333, 5.8, 3.8666666666666667, 5.8, 7.733333333333333, 5.8, 5.8, 5.8, 3.8666666666666667, 7.733333333333333, 3.8666666666666667, 7.733333333333333, 3.8666666666666667, 9.666666666666666, 3.8666666666666667, 3.8666666666666667, 5.8, 7.733333333333333, 5.8, 5.8, 3.8666666666666667]

    raid2ppReadRatio=[1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.288888888888889, 1.288888888888889, 1.6111111111111112, 1.6111111111111112, 1.6111111111111112, 1.6111111111111112, 1.6111111111111112, 1.6111111111111112, 1.6111111111111112, 1.6111111111111112, 1.6111111111111112, 1.9333333333333333]
    raid2ppWriteRatio=[1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333, 1.9333333333333333]

    fig, ax = plt.subplots(figsize=(10, 4))

    plt.xlabel('Load Balance Rate', fontsize=20)
    batchSize=30

    ax.set_ylim([0, 1.05])
    ax.set_xlim([1.0, 10])

    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)

    randReadVal, randRead_fs_rv_dist=getCDFPlotValue(randReadRatio)
    randWriteVal, randWrite_fs_rv_dist=getCDFPlotValue(randWriteRatio)

    raid2ppReadVal, raid2ppRead_fs_rv_dist=getCDFPlotValue(raid2ppReadRatio)
    raid2ppWriteVal, raid2ppWrite_fs_rv_dist=getCDFPlotValue(raid2ppWriteRatio)

    plt.plot(randReadVal, randRead_fs_rv_dist.cdf(randReadVal), 'r-', lw=5, alpha=0.6, label="Random Read")
    plt.plot(randWriteVal, randWrite_fs_rv_dist.cdf(randWriteVal), 'g-', lw=5, alpha=0.6, label="Random Write")
    plt.plot(raid2ppReadVal, raid2ppRead_fs_rv_dist.cdf(raid2ppReadVal), 'b-', lw=5, alpha=0.6, label="RAID2pp Read")
    plt.plot(raid2ppWriteVal, raid2ppWrite_fs_rv_dist.cdf(raid2ppWriteVal), 'y-', lw=5, alpha=0.6, label="RAID2pp Write")
    plt.title("CDF", fontsize=20)
    plt.legend(loc="best", fontsize=20)
    plt.savefig("BatchSize=" + str(batchSize) + ".pdf", dpi=600, format="pdf")
    plt.show()


